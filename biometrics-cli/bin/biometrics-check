#!/bin/bash
# biometrics-check - PrÃ¼ft BIOMETRICS Repo Konsistenz

echo "ğŸ” BIOMETRICS REPO CHECK"
echo "========================"
echo ""

# 1. PrÃ¼fe globale Struktur
echo "ğŸ“ Step 1: Hauptverzeichnisse"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
for dir in global local biometrics-cli docs; do
  if [ -d "$dir" ]; then
    echo "  âœ“ $dir/ existiert"
  else
    echo "  âŒ $dir/ FEHLT!"
  fi
done
echo ""

# 2. PrÃ¼fe CLI
echo "ğŸ“ Step 2: BIOMETRICS CLI"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
if [ -d "biometrics-cli/bin/" ]; then
  echo "  âœ“ biometrics-cli/bin/ existiert"
  ls -la biometrics-cli/bin/ | grep -E "^-" | awk '{print "    ğŸ“„ " $9}'
else
  echo "  âŒ biometrics-cli/bin/ FEHLT!"
fi
echo ""

# 3. PrÃ¼fe Configs
echo "âš™ï¸  Step 3: Konfigurationsdateien"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
if [ -f "oh-my-opencode.json" ]; then
  echo "  âœ“ oh-my-opencode.json existiert"
  echo "  ğŸ“Š Agents:"
  cat oh-my-opencode.json | jq -r '.agents | keys[]' | sed 's/^/    - /'
else
  echo "  âŒ oh-my-opencode.json FEHLT!"
fi
echo ""

# 4. PrÃ¼fe Modell-Konsistenz
echo "ğŸ” Step 4: Modell-Namen Konsistenz"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
if grep -r "qwen/qwen3.5-397b-a17b" docs/ >/dev/null 2>&1; then
  echo "  âœ“ qwen/qwen3.5-397b-a17b gefunden in:"
  grep -r "qwen/qwen3.5-397b-a17b" docs/ --include="*.md" | cut -d: -f1 | sort -u | sed 's/^/    - /'
else
  echo "  âš ï¸  qwen/qwen3.5-397b-a17b NICHT gefunden!"
fi
echo ""

# 5. PrÃ¼fe READMEs
echo "ğŸ“– Step 5: READMEs in Hauptverzeichnissen"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
for dir in global local biometrics-cli docs; do
  if [ -f "$dir/README.md" ]; then
    echo "  âœ“ $dir/README.md existiert"
  else
    echo "  âŒ $dir/README.md FEHLT!"
  fi
done
echo ""

# 6. PrÃ¼fe Agent-Mapping
echo "ğŸ¯ Step 6: Agent-Model-Mapping"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
if [ -f "docs/agents/AGENT-MODEL-MAPPING.md" ]; then
  echo "  âœ“ AGENT-MODEL-MAPPING.md existiert"
  echo "  ğŸ“Š VerfÃ¼gbare Modelle:"
  grep -A 2 "| \*\*" docs/agents/AGENT-MODEL-MAPPING.md | grep "| \*\*" | sed 's/^/    /'
else
  echo "  âŒ AGENT-MODEL-MAPPING.md FEHLT!"
fi
echo ""

# 7. PrÃ¼fe Loop-Config
echo "ğŸ”„ Step 7: DELQHI-LOOP Konfiguration"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
if [ -f "âˆBestâˆPracticesâˆLoop.md" ]; then
  echo "  âœ“ âˆBestâˆPracticesâˆLoop.md existiert"
  if grep -q "3 Agents parallel" "âˆBestâˆPracticesâˆLoop.md"; then
    echo "  âœ“ 3 Agents parallel korrekt konfiguriert"
  else
    echo "  âš ï¸  3 Agents parallel NICHT gefunden!"
  fi
else
  echo "  âŒ âˆBestâˆPracticesâˆLoop.md FEHLT!"
fi
echo ""

# 8. Zusammenfassung
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "âœ… CHECK COMPLETE"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# ZÃ¤hle Fehler
ERRORS=0
[ ! -d "global" ] && ((ERRORS++))
[ ! -d "local" ] && ((ERRORS++))
[ ! -d "biometrics-cli" ] && ((ERRORS++))
[ ! -f "oh-my-opencode.json" ] && ((ERRORS++))
[ ! -f "docs/agents/AGENT-MODEL-MAPPING.md" ] && ((ERRORS++))
[ ! -f "âˆBestâˆPracticesâˆLoop.md" ] && ((ERRORS++))

if [ $ERRORS -eq 0 ]; then
  echo "ğŸ‰ ALLE CHECKS BESTANDEN!"
  exit 0
else
  echo "âš ï¸  $ERRORS FEHLER GEFUNDEN!"
  exit 1
fi
